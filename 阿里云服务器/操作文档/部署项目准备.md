# 部署项目准备

## 基础环境搭建

### 下载Xshell & Xftp6

Xshell用于连接服务器

Xftp6用于文件传输

**下载地址**

* https://www.netsarang.com/zh/all-downloads/?code=623

#### Xshell连接服务器

![alt](img/xshell-connect.png)



#### Xftp6连接服务器

> 与Xshell连接类似





### 安装SSM项目必要环境

#### 安装jdk

```shell
yum -y install java-1.8.0-openjdk.x86_64
```

##### 查询jdk版本

```shell
java -version
```



#### 安装MySQL

```shell
cd /tmp
wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm  
rpm -ivh mysql-community-release-el7-5.noarch.rpm  
```

执行

```shell
yum install mysql mysql-server mysql-devel -y
```

启动MySQL

```shell
systemctl start mysql.service
```



**进入MySQL命令**

> 一开始没有密码，直接`mysql`即可进入`mysql`命令行



**设置MySQL密码**

```shell
set password = password('root');
```



**带密码进入MySQL命令行**

```shell
mysql -u root -p****
```

`root` 用户名

`****` 密码





### 安装Tomcat

下载地址

* [https://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/](https://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/)

选择版本

* `/tomcat-8/v8.5.50/bin/` 
* 选择该目录下的 `apache-tomcat-8.5.50.tar.gz `



将压缩文件通过**Xftp**放入`/usr/local`目录下

![alt](img/tomcat1.png)

解压并将文件名修改为`tomcat8`

```shell
tar xzf apache-tomcat-8.5.50.tar.gz
```

![alt](img/tomcat2.png)



启动tomcat

```shell
 cd /usr/local/tomcat8/bin
./startup.sh
```



**打开阿里云管理控制台，设置安全组**

> 此步骤避免安全拦截

![alt](img/tomcat3.png)

测试打开

> 运行Tomcat后第一次打开页面**等待时间较长**

![alt](img/tomcat4.png)





#### 更多操作



##### 修改Tomcat默认端口号

进入`/usr/local/tomcat8/conf` 修改`server.xml`文件

![alt](img/tomcat5.png)

##### 关闭Tomcat

进入bin目录

```shell
cd /usr/local/tomcat8/bin
```

使用Tomcat关闭命令

```shell
./shutdown.sh
```



##### 查看Tomcat状态

运行进程查看

```shell
ps -ef|grep java
```

> 如果显示`root 19955 19757 0 17:48 pts/0 00:00:00 grep java`表示Tomcat已关闭



以下信息是运行状态，可以查看Tomcat进程，**红框部分是进程号**

![alt](img/tomcat6.png)



可以使用`kill`命令强制关闭Tomcat进程

```shell
 kill -9 2834
```



查看Tomcat运行端口

```shell
sudo netstat -apn | grep 2834
```

![alt](img/tomcat7.png)





### 配置Node.js环境

下载地址

* [http://nodejs.cn/download/](http://nodejs.cn/download/)

下载`Linux二进制文件`

![alt](img/node1.png)

将压缩文件通过**Xftp**放入`/usr/local`目录下

![alt](img/node2.png)



解压文件，并修改文件名为`nodejs12`

```shell
tar -xvf node-v12.14.1-linux-x64.tar.xz
```

![alt](img/nodejs12.png)



创建软链接，这样就可以在任意目录下直接使用node和npm命令

`/usr/local/nodejs12/bin/node` node环境地址

`/usr/local/bin/node` 链接位置

```shell
ln -s /usr/local/nodejs12/bin/node /usr/local/bin/node
ln -s /usr/local/nodejs12/bin/npm /usr/local/bin/npm
```



查看版本信息 

> 如果软链接配置成功，可以看到版本信息

![alt](img/node3.png)



#### 使用淘宝npm镜像

```shell
npm install -g cnpm --registry=https://registry.npm.taobao.org
```

##### 使用cpnm命令安装模块

```shell
cnpm install [name]
```







## MySQL操作

### 本地数据库导出Sql

#### 使用`mysqldump`

导出ice_mall数据库为ice_mall.sql

```shell
mysqldump -u root -p ice_mall > E:/ice_mall.sql
```





#### 服务器导入Sql

将导出的sql复制到服务器下目录

启动mysql，创建名为**ice_mall**的数据库

```shell
mysql -u root -p****
create database ice_mall default character set utf-8
```



导入`ice_mall.sql`

```shell
ice_mall < /usr/local/ice_mall.sql
```





### IDEA远程连接数据库



#### 服务器端开启`3306`端口访问

![alt](img/idea3.png)

#### 远程连接报错解决

> Host * is not allowed to connect to this MySQL server

将localhost改成%

```mysql
use mysql
update user set host = '%'
where user = 'root' and host = 'localhost'
flush privileges;   # 刷新
```



#### 连接数据库

![alt](img/idea1.png)



**解决无法查看数据库表的问题**

在设置页，选择`Schemas` ,勾选`ice_mall`

![alt](img/idea2.png)



